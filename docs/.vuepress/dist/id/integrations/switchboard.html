<!DOCTYPE html>
<html lang="id-ID">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="title" content="Buku Panduan Solana | Menggunakan Switchboard untuk membuat Onchain data feeds"><meta name="og:title" content="Buku Panduan Solana | Menggunakan Switchboard untuk membuat Onchain data feeds"><meta name="description" content="Switchboard memungkinkan pembuat untuk membuka kunci kekuatan Solana dengan membuat feeds data berkinerja tinggi dari API apa pun."><meta name="og:description" content="Switchboard memungkinkan pembuat untuk membuka kunci kekuatan Solana dengan membuat feeds data berkinerja tinggi dari API apa pun."><meta name="og:image" content="https://solanacookbook.com/cookbook-sharing-card.png"><meta name="og:image:alt" content="Solana splash card"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@solanacookbook"><meta name="twitter:image" content="https://solanacookbook.com/cookbook-sharing-card.png"><meta name="robots" content="index,follow,noodp"><meta name="googlebot" content="index,follow"><link rel="icon" href="/solana_cookbook_lightmode.svg"><script data-domain="solanacookbook.com" src="https://plausible.io/js/plausible.js"></script><title>Switchboard | Buku Panduan Solana</title>
    <link rel="modulepreload" href="/assets/app.c241040b.js"><link rel="modulepreload" href="/assets/switchboard.html.268deb26.js"><link rel="modulepreload" href="/assets/switchboard.html.a74044d8.js">
    <link rel="stylesheet" href="/assets/style.fecd2c41.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/id/" class=""><!----><span class="site-name can-hide">Buku Panduan Solana</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/solana-developers/solana-cookbook" rel="noopener noreferrer" target="_blank" aria-label="Kontribusi"><!--[--><!--]--> Kontribusi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/id/integrations" class="router-link-active" aria-label="Integrasi"><!--[--><!--]--> Integrasi <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/integrations/switchboard.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/es/" class="" aria-label="Spanish"><!--[--><!--]--> Spanish <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vi/integrations/switchboard.html" class="" aria-label="Tiếng Việt"><!--[--><!--]--> Tiếng Việt <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/th/integrations/switchboard.html" class="" aria-label="ไทย"><!--[--><!--]--> ไทย <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/fr/integrations/switchboard.html" class="" aria-label="Français"><!--[--><!--]--> Français <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/id/integrations/switchboard.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Bahasa Indonesia"><!--[--><!--]--> Bahasa Indonesia <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/solana-developers/solana-cookbook" rel="noopener noreferrer" target="_blank" aria-label="Kontribusi"><!--[--><!--]--> Kontribusi <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/id/integrations" class="router-link-active" aria-label="Integrasi"><!--[--><!--]--> Integrasi <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/integrations/switchboard.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zh/" class="" aria-label="中文"><!--[--><!--]--> 中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/es/" class="" aria-label="Spanish"><!--[--><!--]--> Spanish <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/vi/integrations/switchboard.html" class="" aria-label="Tiếng Việt"><!--[--><!--]--> Tiếng Việt <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/th/integrations/switchboard.html" class="" aria-label="ไทย"><!--[--><!--]--> ไทย <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/fr/integrations/switchboard.html" class="" aria-label="Français"><!--[--><!--]--> Français <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/id/integrations/switchboard.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Bahasa Indonesia"><!--[--><!--]--> Bahasa Indonesia <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Integrasi <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/id/integrations" class="router-link-active sidebar-item" aria-label="Memulai"><!--[--><!--]--> Memulai <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/serum.html" class="sidebar-item" aria-label="Serum"><!--[--><!--]--> Serum <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/pyth.html" class="sidebar-item" aria-label="Pyth"><!--[--><!--]--> Pyth <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Switchboard"><!--[--><!--]--> Switchboard <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/id/integrations/switchboard.html#data-feeds" class="router-link-active router-link-exact-active sidebar-item" aria-label="Data Feeds"><!--[--><!--]--> Data Feeds <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/id/integrations/switchboard.html#cara-baca-data-dari-aggregator-feeds" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cara Baca Data Dari Aggregator Feeds"><!--[--><!--]--> Cara Baca Data Dari Aggregator Feeds <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#membuat-aggregator-feed-baru" class="router-link-active router-link-exact-active sidebar-item" aria-label="Membuat Aggregator Feed Baru"><!--[--><!--]--> Membuat Aggregator Feed Baru <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#baca-data-dari-aggregator-feeds-dalam-sebuah-program" class="router-link-active router-link-exact-active sidebar-item" aria-label="Baca data dari aggregator feeds dalam sebuah program"><!--[--><!--]--> Baca data dari aggregator feeds dalam sebuah program <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#cara-membuat-a-feeds-dari-publisher" class="router-link-active router-link-exact-active sidebar-item" aria-label="Cara Membuat a Feeds Dari Publisher"><!--[--><!--]--> Cara Membuat a Feeds Dari Publisher <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/id/integrations/switchboard.html#oracles" class="router-link-active router-link-exact-active sidebar-item" aria-label="Oracles"><!--[--><!--]--> Oracles <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/id/integrations/switchboard.html#create-an-oracle" class="router-link-active router-link-exact-active sidebar-item" aria-label="Create an oracle"><!--[--><!--]--> Create an oracle <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#menjalan-oracle-di-lokal" class="router-link-active router-link-exact-active sidebar-item" aria-label="Menjalan Oracle di lokal"><!--[--><!--]--> Menjalan Oracle di lokal <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#konfigurasi-oracle" class="router-link-active router-link-exact-active sidebar-item" aria-label="Konfigurasi Oracle"><!--[--><!--]--> Konfigurasi Oracle <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/id/integrations/switchboard.html#fungsi-random-yang-terverifikasi-verifiable-random-function-vrf" class="router-link-active router-link-exact-active sidebar-item" aria-label="Fungsi Random yang Terverifikasi - Verifiable Random Function(VRF)"><!--[--><!--]--> Fungsi Random yang Terverifikasi - Verifiable Random Function(VRF) <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/id/integrations/switchboard.html#membaca-akun-vrf" class="router-link-active router-link-exact-active sidebar-item" aria-label="Membaca akun VRF"><!--[--><!--]--> Membaca akun VRF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#membuat-sebuah-akun-vrf" class="router-link-active router-link-exact-active sidebar-item" aria-label="Membuat Sebuah Akun VRF"><!--[--><!--]--> Membuat Sebuah Akun VRF <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#request-randomness-dari-akun-vrf" class="router-link-active router-link-exact-active sidebar-item" aria-label="Request Randomness dari akun  vrf"><!--[--><!--]--> Request Randomness dari akun  vrf <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/id/integrations/switchboard.html#sumber" class="router-link-active router-link-exact-active sidebar-item" aria-label="Sumber"><!--[--><!--]--> Sumber <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/id/integrations/switchboard.html#api-dan-librari" class="router-link-active router-link-exact-active sidebar-item" aria-label="API dan Librari"><!--[--><!--]--> API dan Librari <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#contoh" class="router-link-active router-link-exact-active sidebar-item" aria-label="Contoh"><!--[--><!--]--> Contoh <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/id/integrations/switchboard.html#informasi-lebih-lanjut" class="router-link-active router-link-exact-active sidebar-item" aria-label="Informasi Lebih Lanjut"><!--[--><!--]--> Informasi Lebih Lanjut <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a href="/id/integrations/mango.html" class="sidebar-item" aria-label="Mango Markets"><!--[--><!--]--> Mango Markets <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/strata.html" class="sidebar-item" aria-label="Strata"><!--[--><!--]--> Strata <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/web3auth.html" class="sidebar-item" aria-label="web3Auth (Torus Wallet)"><!--[--><!--]--> web3Auth (Torus Wallet) <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/react-native.html" class="sidebar-item" aria-label="React Native"><!--[--><!--]--> React Native <!--[--><!--]--></a><!----></li><li><a href="/id/integrations/jupiter.html" class="sidebar-item" aria-label="Jupiter"><!--[--><!--]--> Jupiter <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="switchboard" tabindex="-1"><a class="header-anchor" href="#switchboard" aria-hidden="true">#</a> Switchboard</h1><p>Switchboard adalah protokol Oracle yang memungkinkan pengembang untuk menarik data on-chain untuk berbagai kasus penggunaan seperti feed harga, harga dasar NFT, statistik olahraga, atau bahkan keacakan yang dapat diverifikasi. Secara umum, Switchboard adalah sumber daya off-chain yang dapat digunakan untuk menjembatani data dengan integritas tinggi secara on-chain dan memberi daya pada web3 dan DeFi.</p><h2 id="data-feeds" tabindex="-1"><a class="header-anchor" href="#data-feeds" aria-hidden="true">#</a> Data Feeds</h2><p>Switchboard menyediakan librari JavaScript/TypeScript yang disebut <strong>@switchboard-xyz/switchboard-v2</strong> . Librari ini bisa digunakan untuk mendapatkan on-chain data dari feeds yang sudah ada atau bisa juga untuk mempublikasikan feeds kustom. Pelajari lebih lanjut <a href="https://www.npmjs.com/package/@switchboard-xyz/switchboard-v2" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="cara-baca-data-dari-aggregator-feeds" tabindex="-1"><a class="header-anchor" href="#cara-baca-data-dari-aggregator-feeds" aria-hidden="true">#</a> Cara Baca Data Dari Aggregator Feeds</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  clusterApiUrl<span class="token punctuation">,</span>
  Connection<span class="token punctuation">,</span>
  Keypair<span class="token punctuation">,</span>
  PublicKey<span class="token punctuation">,</span>
  <span class="token constant">LAMPORTS_PER_SOL</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> switchboard <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> payer <span class="token operator">=</span> Keypair<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connection</span><span class="token punctuation">(</span><span class="token function">clusterApiUrl</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> switchboard<span class="token punctuation">.</span><span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span>
    <span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span>
    connection<span class="token punctuation">,</span>
    payer
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> airdropSignature <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">requestAirdrop</span><span class="token punctuation">(</span>
    payer<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
    <span class="token constant">LAMPORTS_PER_SOL</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">confirmTransaction</span><span class="token punctuation">(</span>airdropSignature<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> aggregatorAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">switchboard</span><span class="token punctuation">.</span><span class="token function">AggregatorAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    program<span class="token operator">:</span> program<span class="token punctuation">,</span>
    publicKey<span class="token operator">:</span> aggregatorKey<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token keyword">await</span> aggregatorAccount<span class="token punctuation">.</span><span class="token function">getLatestValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">let</span> aggregatorKey<span class="token operator">:</span> PublicKey<span class="token punctuation">;</span>
<span class="token keyword">let</span> program<span class="token operator">:</span> Program<span class="token operator">&lt;</span>Idl<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aggregatorAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">switchboard</span><span class="token punctuation">.</span><span class="token function">AggregatorAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token operator">:</span> program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> aggregatorKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token keyword">await</span> aggregatorAccount<span class="token punctuation">.</span><span class="token function">getLatestValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="membuat-aggregator-feed-baru" tabindex="-1"><a class="header-anchor" href="#membuat-aggregator-feed-baru" aria-hidden="true">#</a> Membuat Aggregator Feed Baru</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> anchor <span class="token keyword">from</span> <span class="token string">&quot;@project-serum/anchor&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Keypair <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  AggregatorAccount<span class="token punctuation">,</span>
  loadSwitchboardProgram<span class="token punctuation">,</span>
  LeaseAccount<span class="token punctuation">,</span>
  OracleQueueAccount<span class="token punctuation">,</span>
  SwitchboardPermission<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> payer<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">let</span> authority<span class="token operator">:</span> Keypair<span class="token punctuation">;</span> <span class="token comment">// queue authority</span>
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> payer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OracleQueueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> queuePubkey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// aggregator</span>
<span class="token keyword">const</span> aggregatorAccount <span class="token operator">=</span> <span class="token keyword">await</span> AggregatorAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;MY SOL/USD Feed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  batchSize<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minRequiredOracleResults<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minRequiredJobResults<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minUpdateDelaySeconds<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  queueAccount<span class="token punctuation">,</span>
  authority<span class="token operator">:</span> authority<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// permission</span>
<span class="token keyword">const</span> permissionAccount <span class="token operator">=</span> <span class="token keyword">await</span> PermissionAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  authority<span class="token operator">:</span> authority<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
  granter<span class="token operator">:</span> queueAccount<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
  grantee<span class="token operator">:</span> aggregatorAccount<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> aggregatorPermission<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authority<span class="token punctuation">,</span>
  permission<span class="token operator">:</span> SwitchboardPermission<span class="token punctuation">.</span><span class="token constant">PERMIT_ORACLE_QUEUE_USAGE</span><span class="token punctuation">,</span>
  enable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// lease</span>
<span class="token keyword">const</span> leaseContract <span class="token operator">=</span> <span class="token keyword">await</span> LeaseAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  loadAmount<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">anchor</span><span class="token punctuation">.</span><span class="token constant">BN</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  funder<span class="token operator">:</span> tokenAccount<span class="token punctuation">,</span>
  funderAuthority<span class="token operator">:</span> authority<span class="token punctuation">,</span>
  oracleQueueAccount<span class="token operator">:</span> queueAccount<span class="token punctuation">,</span>
  aggregatorAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// job</span>
<span class="token keyword">const</span> tasks<span class="token operator">:</span> OracleJob<span class="token punctuation">.</span>Task<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  OracleJob<span class="token punctuation">.</span>Task<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    httpTask<span class="token operator">:</span> OracleJob<span class="token punctuation">.</span>HttpTask<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://ftx.us/api/markets/SOL_USD</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  OracleJob<span class="token punctuation">.</span>Task<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    jsonParseTask<span class="token operator">:</span> OracleJob<span class="token punctuation">.</span>JsonParseTask<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;$.result.price&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jobData <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>
  OracleJob<span class="token punctuation">.</span><span class="token function">encodeDelimited</span><span class="token punctuation">(</span>
    OracleJob<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      tasks<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jobKeypair <span class="token operator">=</span> anchor<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>Keypair<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jobAccount <span class="token operator">=</span> <span class="token keyword">await</span> JobAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> jobData<span class="token punctuation">,</span>
  keypair<span class="token operator">:</span> jobKeypair<span class="token punctuation">,</span>
  authority<span class="token operator">:</span> authority<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// add job to aggregator</span>
<span class="token keyword">await</span> aggregatorAccount<span class="token punctuation">.</span><span class="token function">addJob</span><span class="token punctuation">(</span>jobAccount<span class="token punctuation">,</span> authority<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OracleQueueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> queuePubkey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aggregatorAccount <span class="token operator">=</span> <span class="token keyword">await</span> AggregatorAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;MY SOL/USD Feed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  batchSize<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minRequiredOracleResults<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minRequiredJobResults<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  minUpdateDelaySeconds<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  queueAccount<span class="token punctuation">,</span>
  authority<span class="token operator">:</span> authority<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aggregatorAccount<span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="baca-data-dari-aggregator-feeds-dalam-sebuah-program" tabindex="-1"><a class="header-anchor" href="#baca-data-dari-aggregator-feeds-dalam-sebuah-program" aria-hidden="true">#</a> Baca data dari aggregator feeds dalam sebuah program</h3><p>Switchboard menyediakan sebuah crate yang dinamakan <strong>switchboard_v2</strong> Pelajari lebih lanjut <a href="https://docs.rs/switchboard-v2/0.1.10/switchboard_v2/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Rust</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">anchor_lang<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">switchboard_v2<span class="token punctuation">::</span></span><span class="token class-name">AggregatorAccountData</span><span class="token punctuation">;</span>

<span class="token macro property">declare_id!</span><span class="token punctuation">(</span><span class="token string">&quot;HDa6A4wLjEymb8Cv3UGeGBnFUNCUEMpoiVBbkTKAkfrt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[program]</span>
<span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">get_result</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
   
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">get_result</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token operator">&lt;</span><span class="token class-name">GetResult</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> aggregator <span class="token operator">=</span> <span class="token operator">&amp;</span>ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>aggregator_feed<span class="token punctuation">;</span>
        <span class="token keyword">let</span> val<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token class-name">AggregatorAccountData</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>aggregator<span class="token punctuation">)</span><span class="token operator">?</span>
            <span class="token punctuation">.</span><span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span>
            <span class="token punctuation">.</span><span class="token function">try_into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;Current feed result is {}!&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
   
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Accounts)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">GetResult</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> authority<span class="token punctuation">:</span> <span class="token class-name">Signer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token comment">/// CHECK: field is unsafe</span>
    <span class="token keyword">pub</span> aggregator_feed<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// pass aggregator key</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> aggregator <span class="token operator">=</span> <span class="token operator">&amp;</span>ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>aggregator_feed<span class="token punctuation">;</span>
<span class="token keyword">let</span> val<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token class-name">AggregatorAccountData</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>aggregator<span class="token punctuation">)</span><span class="token operator">?</span>
            <span class="token punctuation">.</span><span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span>
            <span class="token punctuation">.</span><span class="token function">try_into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="cara-membuat-a-feeds-dari-publisher" tabindex="-1"><a class="header-anchor" href="#cara-membuat-a-feeds-dari-publisher" aria-hidden="true">#</a> Cara Membuat a Feeds Dari Publisher</h3><p>Dokumentasi Switchboard resmi memiliki panduan mendalam tentang cara membuat feeds dari penerbit. Cek lebih lanjut <a href="https://docs.switchboard.xyz/feed/publisher" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="oracles" tabindex="-1"><a class="header-anchor" href="#oracles" aria-hidden="true">#</a> Oracles</h2><p>Fitur unik Switchboard adalah memungkinkan Anda membuat oracle Anda sendiri dan menjalankannya secara lokal.</p><h3 id="create-an-oracle" tabindex="-1"><a class="header-anchor" href="#create-an-oracle" aria-hidden="true">#</a> Create an oracle</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> anchor <span class="token keyword">from</span> <span class="token string">&quot;@project-serum/anchor&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Keypair <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  loadSwitchboardProgram<span class="token punctuation">,</span>
  OracleAccount<span class="token punctuation">,</span>
  OracleQueueAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> payer<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> payer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OracleQueueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> queuePubkey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create oracle</span>
<span class="token keyword">const</span> oracleAccount <span class="token operator">=</span> <span class="token keyword">await</span> OracleAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;My Oracle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  queueAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OracleQueueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> queuePubkey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create oracle</span>
<span class="token keyword">const</span> oracleAccount <span class="token operator">=</span> <span class="token keyword">await</span> OracleAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;My Oracle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  queueAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="menjalan-oracle-di-lokal" tabindex="-1"><a class="header-anchor" href="#menjalan-oracle-di-lokal" aria-hidden="true">#</a> Menjalan Oracle di lokal</h3><p>Anda dapat menjalankan oracle secara lokal dan menetapkannya ke antrian oracle Anda sendiri untuk menguji bagaimana program Anda dapat beroperasi dalam environment production. Oracle Mainnet harus selalu dijalankan di lingkungan ketersediaan tinggi dengan beberapa kemampuan pemantauan.</p><h4 id="yang-dibutuhkan" tabindex="-1"><a class="header-anchor" href="#yang-dibutuhkan" aria-hidden="true">#</a> Yang Dibutuhkan</h4><ul><li>Docker-compose</li></ul><p>Buat sebuah file docker-compose.yml dengan environment variable di <a href="/integrations/switchboard.html#oracle-config" class="">Oracle Config</a></p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.3&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">switchboard</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&quot;switchboardlabs/node:dev-v2-5-28-22a&quot;</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> LIVE=1
      <span class="token punctuation">-</span> CLUSTER=devnet
      <span class="token punctuation">-</span> RPC_URL=$<span class="token punctuation">{</span>RPC_URL<span class="token punctuation">}</span>
      <span class="token punctuation">-</span> ORACLE_KEY=$<span class="token punctuation">{</span>ORACLE_KEY<span class="token punctuation">}</span>
      <span class="token punctuation">-</span> HEARTBEAT_INTERVAL=15
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./configs.json<span class="token punctuation">:</span>/configs.json
<span class="token key atrule">secrets</span><span class="token punctuation">:</span>
  <span class="token key atrule">PAYER_SECRETS</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> /filesystem/path/to/keypair.json
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.3&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">switchboard</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&quot;switchboardlabs/node:dev-v2-5-28-22a&quot;</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> LIVE=1
      <span class="token punctuation">-</span> CLUSTER=devnet
      <span class="token punctuation">-</span> RPC_URL=$<span class="token punctuation">{</span>RPC_URL<span class="token punctuation">}</span>
      <span class="token punctuation">-</span> ORACLE_KEY=$<span class="token punctuation">{</span>ORACLE_KEY<span class="token punctuation">}</span>
      <span class="token punctuation">-</span> HEARTBEAT_INTERVAL=15
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./configs.json<span class="token punctuation">:</span>/configs.json
<span class="token key atrule">secrets</span><span class="token punctuation">:</span>
  <span class="token key atrule">PAYER_SECRETS</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> /filesystem/path/to/keypair.json
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><!--]--></div></div><!--]--></div><p>Jalankan container dengan <code>docker-compose up</code></p><h3 id="konfigurasi-oracle" tabindex="-1"><a class="header-anchor" href="#konfigurasi-oracle" aria-hidden="true">#</a> Konfigurasi Oracle</h3><table><thead><tr><th>Env Variable</th><th>Definisi</th></tr></thead><tbody><tr><td>ORACLE_KEY</td><td><b><u>Dibutuhkan</u></b><br><b>Tipe</b> - Public Key <br><b>Deskripsi</b> - Public key dari sebuah oracle account yang sudah mendapatkan izin untuk menggunakan oracle queue <br></td></tr><tr><td>HEARTBEAT_INTERVAL</td><td><b><u>Opsional</u></b><br><b>Tipe</b> - Number (detik) <br><b>Default</b> - 30 <br><b>Deskripsi</b> - detik antara oracle heartbeats. Queues bisa memiliki oracle heartbeat yang berbeda. Nilai yang direkomendasikan adalah 15 </td></tr><tr><td>GCP_CONFIG_BUCKET</td><td><b><u>Opsional</u></b><br><b>Tipe</b> - GCP Resource Path <br><b>Default</b> - Cari file configs.json di folder, jika tidak ditemukan maka tidak ada config yang di load. <br><b>Deskripsi</b> - Mengandung API keys untuk private API endpoints </td></tr><tr><td>UNWRAP_STAKE_THRESHOLD</td><td><b><u>Optsonal</u></b><br><b>Tipe</b> - Number (jumlah SOL, Contoh. 1.55) <br><b>Default</b> - 0, disabled. <br><b>Deskripsi</b> - Jumlah saldo Solana untuk memicu tindakan pasak yang dibuka (_unwrap stake action_). Ketika balance Solana oracle turun di bawah ambang batas yang ditetapkan, node akan secara otomatis membuka dana dari dompet staking oracle, menyisakan setidaknya 0,1 wSOL atau 10% lebih banyak dari persyaratan stake minimum antrian. </td></tr></tbody></table><h2 id="fungsi-random-yang-terverifikasi-verifiable-random-function-vrf" tabindex="-1"><a class="header-anchor" href="#fungsi-random-yang-terverifikasi-verifiable-random-function-vrf" aria-hidden="true">#</a> Fungsi Random yang Terverifikasi - Verifiable Random Function(VRF)</h2><p>Verifiable Random Function (VRF) adalah fungsi pseudorandom dari public-key yang menyediakan bukti bahwa output telah di kalkukasi secara benar.</p><h3 id="membaca-akun-vrf" tabindex="-1"><a class="header-anchor" href="#membaca-akun-vrf" aria-hidden="true">#</a> Membaca akun VRF</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Rust</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> anchor <span class="token keyword">from</span> <span class="token string">&quot;@project-serum/anchor&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Keypair <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  loadSwitchboardProgram<span class="token punctuation">,</span>
  VrfAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> payer<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> payer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> vrfAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VrfAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> vrfKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> vrf <span class="token operator">=</span> <span class="token keyword">await</span> vrfAccount<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vrf<span class="token punctuation">.</span>currentRound<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> vrfAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VrfAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> vrfKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> vrf <span class="token operator">=</span> <span class="token keyword">await</span> vrfAccount<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vrf<span class="token punctuation">.</span>currentRound<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><!--]--></div></div><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">switchboard_v2<span class="token punctuation">::</span></span><span class="token class-name">VrfAccountData</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> vrf <span class="token operator">=</span> <span class="token class-name">VrfAccountData</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>vrf_account_info<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result_buffer <span class="token operator">=</span> vrf<span class="token punctuation">.</span><span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> result_buffer <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;vrf buffer empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token namespace">bytemuck<span class="token punctuation">::</span></span><span class="token function">cast_slice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>result_buffer<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">256000</span> <span class="token keyword">as</span> <span class="token keyword">u128</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> vrf <span class="token operator">=</span> <span class="token class-name">VrfAccountData</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>vrf_account_info<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result_buffer <span class="token operator">=</span> vrf<span class="token punctuation">.</span><span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="membuat-sebuah-akun-vrf" tabindex="-1"><a class="header-anchor" href="#membuat-sebuah-akun-vrf" aria-hidden="true">#</a> Membuat Sebuah Akun VRF</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> anchor <span class="token keyword">from</span> <span class="token string">&quot;@project-serum/anchor&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Keypair <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  loadSwitchboardProgram<span class="token punctuation">,</span>
  OracleQueueAccount<span class="token punctuation">,</span>
  PermissionAccount<span class="token punctuation">,</span>
  SwitchboardPermission<span class="token punctuation">,</span>
  VrfAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> payer<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> payer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">queueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span> program<span class="token punctuation">,</span> publicKey<span class="token operator">:</span> queueKey <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token keyword">await</span> queueAccount<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// load client program used for callback</span>
<span class="token keyword">const</span> vrfClientProgram <span class="token operator">=</span> anchor<span class="token punctuation">.</span>workspace
  <span class="token punctuation">.</span>AnchorVrfParser <span class="token keyword">as</span> anchor<span class="token punctuation">.</span>Program<span class="token operator">&lt;</span>AnchorVrfParser<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> vrfSecret <span class="token operator">=</span> anchor<span class="token punctuation">.</span>web3<span class="token punctuation">.</span>Keypair<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> vrfIxCoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">anchor</span><span class="token punctuation">.</span><span class="token function">BorshInstructionCoder</span><span class="token punctuation">(</span>vrfClientProgram<span class="token punctuation">.</span>idl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> vrfClientCallback<span class="token operator">:</span> Callback <span class="token operator">=</span> <span class="token punctuation">{</span>
  programId<span class="token operator">:</span> vrfClientProgram<span class="token punctuation">.</span>programId<span class="token punctuation">,</span>
  accounts<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ensure all accounts in updateResult are populated</span>
    <span class="token punctuation">{</span> pubkey<span class="token operator">:</span> vrfClientKey<span class="token punctuation">,</span> isSigner<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isWritable<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> pubkey<span class="token operator">:</span> vrfSecret<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span> isSigner<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isWritable<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  ixData<span class="token operator">:</span> vrfIxCoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;updateResult&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// pass any params for instruction here</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// create VRF</span>
<span class="token keyword">const</span> vrfAccount <span class="token operator">=</span> <span class="token keyword">await</span> VrfAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  queue<span class="token operator">:</span> queueAccount<span class="token punctuation">,</span>
  callback<span class="token operator">:</span> vrfClientCallback<span class="token punctuation">,</span>
  authority<span class="token operator">:</span> vrfClientKey<span class="token punctuation">,</span> <span class="token comment">// vrf authority</span>
  keypair<span class="token operator">:</span> vrfSecret<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create permission</span>
<span class="token keyword">const</span> permissionAccount <span class="token operator">=</span> <span class="token keyword">await</span> PermissionAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  authority<span class="token operator">:</span> queue<span class="token punctuation">.</span>authority<span class="token punctuation">,</span>
  granter<span class="token operator">:</span> queue<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
  grantee<span class="token operator">:</span> vrfAccount<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// if queue has not enabled unpermissionedVrfEnabled, queue will need to grant permission</span>
<span class="token keyword">let</span> queueAuthority<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">await</span> permissionAccount<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authority<span class="token operator">:</span> queueAuthority<span class="token punctuation">,</span>
  permission<span class="token operator">:</span> SwitchboardPermission<span class="token punctuation">.</span><span class="token constant">PERMIT_VRF_REQUESTS</span><span class="token punctuation">,</span>
  enable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> vrfAccount <span class="token operator">=</span> <span class="token keyword">await</span> VrfAccount<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  queue<span class="token operator">:</span> queueAccount<span class="token punctuation">,</span>
  callback<span class="token operator">:</span> vrfClientCallback<span class="token punctuation">,</span>
  authority<span class="token operator">:</span> vrfClientKey<span class="token punctuation">,</span> <span class="token comment">// vrf authority</span>
  keypair<span class="token operator">:</span> vrfSecret<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><!--]--></div></div><!--]--></div><h3 id="request-randomness-dari-akun-vrf" tabindex="-1"><a class="header-anchor" href="#request-randomness-dari-akun-vrf" aria-hidden="true">#</a> Request Randomness dari akun vrf</h3><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><!--[--><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">TS</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Rust</button></li><!--]--><li class="flex-grow"></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg></button></li><li class="code-group__li"><button class="code-group__nav-tab"><svg width="18" height="18" viewbox="0 0 24 24" fill="none"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></button></li></ul></div><div><div class="code-info-title">Press &lt;/&gt; button to view full source</div></div><!--[--><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> anchor <span class="token keyword">from</span> <span class="token string">&quot;@project-serum/anchor&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Keypair <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  loadSwitchboardProgram<span class="token punctuation">,</span>
  VrfAccount<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@switchboard-xyz/switchboard-v2&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> payer<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">let</span> authority<span class="token operator">:</span> Keypair<span class="token punctuation">;</span>
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadSwitchboardProgram</span><span class="token punctuation">(</span><span class="token string">&quot;devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> payer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> vrfAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VrfAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> vrfKey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> vrf <span class="token operator">=</span> <span class="token keyword">await</span> vrfAccount<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> queueAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OracleQueueAccount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  program<span class="token punctuation">,</span>
  publicKey<span class="token operator">:</span> vrf<span class="token punctuation">.</span>queuePubkey<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token keyword">await</span> queueAccount<span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mint <span class="token operator">=</span> <span class="token keyword">await</span> queueAccount<span class="token punctuation">.</span><span class="token function">loadMint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> payerTokenWallet <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token keyword">await</span> mint<span class="token punctuation">.</span><span class="token function">getOrCreateAssociatedAccountInfo</span><span class="token punctuation">(</span>payer<span class="token punctuation">.</span>publicKey<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>address<span class="token punctuation">;</span>

<span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token keyword">await</span> vrfAccount<span class="token punctuation">.</span><span class="token function">requestRandomness</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authority<span class="token punctuation">,</span>
  payer<span class="token operator">:</span> payerTokenWallet<span class="token punctuation">,</span>
  payerAuthority<span class="token operator">:</span> payer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token keyword">await</span> vrfAccount<span class="token punctuation">.</span><span class="token function">requestRandomness</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authority<span class="token punctuation">,</span>
  payer<span class="token operator">:</span> payerTokenWallet<span class="token punctuation">,</span>
  payerAuthority<span class="token operator">:</span> payer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><!--]--></div></div><div class="code-group-item code-group-item__active" aria-selected="true" data-v-6ae3d40e><div class="" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">anchor_lang<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">use</span> <span class="token namespace">switchboard_v2<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">VrfAccountData</span><span class="token punctuation">,</span> <span class="token class-name">VrfRequestRandomness</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">anchor_spl<span class="token punctuation">::</span>token<span class="token punctuation">::</span></span><span class="token class-name">Token</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">anchor_lang<span class="token punctuation">::</span>solana_program<span class="token punctuation">::</span></span>clock<span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Accounts)]</span>
<span class="token attribute attr-name">#[instruction(params: RequestResultParams)]</span> <span class="token comment">// rpc parameters hint</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">RequestResult</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    #<span class="token punctuation">[</span><span class="token function">account</span><span class="token punctuation">(</span>
        <span class="token keyword">mut</span><span class="token punctuation">,</span>
        seeds <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token constant">STATE_SEED</span><span class="token punctuation">,</span>
            vrf<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            authority<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        bump <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>bump<span class="token punctuation">,</span>
        has_one <span class="token operator">=</span> vrf<span class="token punctuation">,</span>
        has_one <span class="token operator">=</span> authority
    <span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">pub</span> state<span class="token punctuation">:</span> <span class="token class-name">AccountLoader</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token punctuation">,</span> <span class="token class-name">VrfClient</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(signer)]</span>
    <span class="token keyword">pub</span> authority<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(constraint = switchboard_program.executable == true)]</span>
    <span class="token keyword">pub</span> switchboard_program<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(mut, constraint = vrf.owner.as_ref() == switchboard_program.key().as_ref())]</span>
    <span class="token keyword">pub</span> vrf<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(mut, constraint = oracle_queue.owner.as_ref() == switchboard_program.key().as_ref())]</span>
    <span class="token keyword">pub</span> oracle_queue<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">pub</span> queue_authority<span class="token punctuation">:</span> <span class="token class-name">UncheckedAccount</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(constraint = data_buffer.owner.as_ref() == switchboard_program.key().as_ref())]</span>
    <span class="token keyword">pub</span> data_buffer<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(mut, constraint = permission.owner.as_ref() == switchboard_program.key().as_ref())]</span>
    <span class="token keyword">pub</span> permission<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(mut, constraint = escrow.owner == program_state.key())]</span>
    <span class="token keyword">pub</span> escrow<span class="token punctuation">:</span> <span class="token class-name">Account</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token punctuation">,</span> <span class="token class-name">TokenAccount</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(mut, constraint = payer_wallet.owner == payer_authority.key())]</span>
    <span class="token keyword">pub</span> payer_wallet<span class="token punctuation">:</span> <span class="token class-name">Account</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token punctuation">,</span> <span class="token class-name">TokenAccount</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(signer)]</span>
    <span class="token keyword">pub</span> payer_authority<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(address = solana_program::sysvar::recent_blockhashes::ID)]</span>
    <span class="token keyword">pub</span> recent_blockhashes<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(constraint = program_state.owner.as_ref() == switchboard_program.key().as_ref())]</span>
    <span class="token keyword">pub</span> program_state<span class="token punctuation">:</span> <span class="token class-name">AccountInfo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[account(address = anchor_spl::token::ID)]</span>
    <span class="token keyword">pub</span> token_program<span class="token punctuation">:</span> <span class="token class-name">Program</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;info</span><span class="token punctuation">,</span> <span class="token class-name">Token</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Clone, AnchorSerialize, AnchorDeserialize)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">RequestResultParams</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> permission_bump<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    <span class="token keyword">pub</span> switchboard_state_bump<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">RequestResult</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">&#39;_</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">validate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> _ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Context</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> _params<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">RequestResultParams</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">actuate</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Context</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">RequestResultParams</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> client_state <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> bump <span class="token operator">=</span> client_state<span class="token punctuation">.</span>bump<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> max_result <span class="token operator">=</span> client_state<span class="token punctuation">.</span>max_result<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">drop</span><span class="token punctuation">(</span>client_state<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> switchboard_program <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>switchboard_program<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> vrf_request_randomness <span class="token operator">=</span> <span class="token class-name">VrfRequestRandomness</span> <span class="token punctuation">{</span>
            authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            vrf<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>vrf<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            oracle_queue<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>oracle_queue<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            queue_authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>queue_authority<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            data_buffer<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>data_buffer<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            permission<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            escrow<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>escrow<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            payer_wallet<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>payer_wallet<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            payer_authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>payer_authority<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            recent_blockhashes<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>recent_blockhashes<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            program_state<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>program_state<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            token_program<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>token_program<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> vrf_key <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>vrf<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> authority_key <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>authority<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;bump: {}&quot;</span><span class="token punctuation">,</span> bump<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;authority: {}&quot;</span><span class="token punctuation">,</span> authority_key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;vrf: {}&quot;</span><span class="token punctuation">,</span> vrf_key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> state_seeds<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>
            <span class="token operator">&amp;</span><span class="token constant">STATE_SEED</span><span class="token punctuation">,</span>
            vrf_key<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            authority_key<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">&amp;</span><span class="token punctuation">[</span>bump<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;requesting randomness&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vrf_request_randomness<span class="token punctuation">.</span><span class="token function">invoke_signed</span><span class="token punctuation">(</span>
            switchboard_program<span class="token punctuation">,</span>
            params<span class="token punctuation">.</span>switchboard_state_bump<span class="token punctuation">,</span>
            params<span class="token punctuation">.</span>permission_bump<span class="token punctuation">,</span>
            state_seeds<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

        <span class="token macro property">emit!</span><span class="token punctuation">(</span><span class="token class-name">RequestingRandomness</span><span class="token punctuation">{</span>
            vrf_client<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            max_result<span class="token punctuation">:</span> max_result<span class="token punctuation">,</span>
            timestamp<span class="token punctuation">:</span> <span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token class-name">Clock</span><span class="token punctuation">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unix_timestamp
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;randomness requested successfully&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><!--]--></div><div class="hidden" data-v-6ae3d40e><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> vrf_request_randomness <span class="token operator">=</span> <span class="token class-name">VrfRequestRandomness</span> <span class="token punctuation">{</span>
    authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    vrf<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>vrf<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    oracle_queue<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>oracle_queue<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    queue_authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>queue_authority<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    data_buffer<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>data_buffer<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    permission<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    escrow<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>escrow<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    payer_wallet<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>payer_wallet<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    payer_authority<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>payer_authority<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    recent_blockhashes<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>recent_blockhashes<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    program_state<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>program_state<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    token_program<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>token_program<span class="token punctuation">.</span><span class="token function">to_account_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> vrf_key <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>vrf<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> authority_key <span class="token operator">=</span> ctx<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>authority<span class="token punctuation">.</span>key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;bump: {}&quot;</span><span class="token punctuation">,</span> bump<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;authority: {}&quot;</span><span class="token punctuation">,</span> authority_key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;vrf: {}&quot;</span><span class="token punctuation">,</span> vrf_key<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> state_seeds<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>
    <span class="token operator">&amp;</span><span class="token constant">STATE_SEED</span><span class="token punctuation">,</span>
    vrf_key<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    authority_key<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">&amp;</span><span class="token punctuation">[</span>bump<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property">msg!</span><span class="token punctuation">(</span><span class="token string">&quot;requesting randomness&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
vrf_request_randomness<span class="token punctuation">.</span><span class="token function">invoke_signed</span><span class="token punctuation">(</span>
    switchboard_program<span class="token punctuation">,</span>
    params<span class="token punctuation">.</span>switchboard_state_bump<span class="token punctuation">,</span>
    params<span class="token punctuation">.</span>permission_bump<span class="token punctuation">,</span>
    state_seeds<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><!--]--></div></div><!--]--></div><h2 id="sumber" tabindex="-1"><a class="header-anchor" href="#sumber" aria-hidden="true">#</a> Sumber</h2><h3 id="api-dan-librari" tabindex="-1"><a class="header-anchor" href="#api-dan-librari" aria-hidden="true">#</a> API dan Librari</h3><ul><li><a href="https://docs.switchboard.xyz/api/tasks" target="_blank" rel="noopener noreferrer">Switchboard Task Types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://docs.rs/switchboard-v2/latest/switchboard_v2/" target="_blank" rel="noopener noreferrer">Rust API Docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://docs.switchboard.xyz/api/ts" target="_blank" rel="noopener noreferrer">Typescript API Docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://docs.switchboard.xyz/api/py" target="_blank" rel="noopener noreferrer">Python API Docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://docs.switchboard.xyz/api/cli" target="_blank" rel="noopener noreferrer">CLI Docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="contoh" tabindex="-1"><a class="header-anchor" href="#contoh" aria-hidden="true">#</a> Contoh</h3><ul><li><a href="https://github.com/switchboard-xyz/switchboard-v2/tree/main/packages/feed-walkthrough" target="_blank" rel="noopener noreferrer">[Client] Custom Data Feed Walkthrough<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/switchboard-xyz/switchboard-v2/tree/main/programs/anchor-feed-parser" target="_blank" rel="noopener noreferrer">[Program] Anchor Feed Parser<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/switchboard-xyz/switchboard-v2/tree/main/programs/anchor-vrf-parser" target="_blank" rel="noopener noreferrer">[Program] Anchor VRF Parser<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="informasi-lebih-lanjut" tabindex="-1"><a class="header-anchor" href="#informasi-lebih-lanjut" aria-hidden="true">#</a> Informasi Lebih Lanjut</h3><ul><li><a href="https://docs.switchboard.xyz/introduction" target="_blank" rel="noopener noreferrer">Protocol Documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://crawling-cent-d6b.notion.site/The-Switchboard-Deep-Dive-717df6ba0b92465e8118351466257a0f" target="_blank" rel="noopener noreferrer">SuperteamDAO Deep Dive<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/id/integrations/pyth.html" class="" aria-label="Pyth"><!--[--><!--]--> Pyth <!--[--><!--]--></a></span><span class="next"><a href="/id/integrations/mango.html" class="" aria-label="Mango Markets"><!--[--><!--]--> Mango Markets <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.c241040b.js" defer></script>
  </body>
</html>
